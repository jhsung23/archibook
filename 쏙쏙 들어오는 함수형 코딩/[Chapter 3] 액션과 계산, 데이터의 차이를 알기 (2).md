# 3. 액션과 계산, 데이터의 차이를 알기 (2)

## 새로 만드는 코드에 함수형 사고 적용하기

생략.

## 계산에 대해 자세히 알아보기

### 계산은 무엇인가요?

- 입력값으로 출력값을 만드는 것
- 실행 시점과 횟수에 관계없이 항상 같은 입력값에 대해 같은 출력값을 돌려줌

### 계산은 어떻게 구현하나요?

- 함수로 구현

### 어떻게 계산에 의미를 담을 수 있나요?

- 계산에는 연산을 담을 수 있음
- 계산은 입력값을 출력값으로 만드는 것을 표현
- 언제 사용할지 또는 어떻게 사용할지는 때에 따라 다름

### 왜 액션보다 계산이 좋나요?

- 테스트하기 쉬움
- 기계적인 분석이 쉬움
- 조합하기 좋음

### 계산을 쓰면서 걱정하지 않아도 되는 것

- 계산이 더 이해하기 쉽기 때문에 가능하면 액션보다 계산을 사용하려 함
- 계산을 쓰면서 걱정하지 않아도 되는 것은 다음과 같음
  - 동시에 실행되는 것
  - 과거에 실행되었던 것이나 미래에 실행할 것
  - 실행 횟수

### 계산의 단점

- 실행하기 전에 어떤 일이 발생할지 알 수 없음
- 코드를 읽으면 예상할 수 있으나, 소프트웨어 측면에서 함수는 블랙박스이므로 입력값으로 실행해야 결과를 알 수 있음
- 이런 단점이 싫다면 계산이나 액션 대신 데이터를 사용해야 함

### 계산은 일반적으로 무엇이라고 하나요?

- 보통 순수 함수 또는 수학 함수라고 부름

## 이미 있는 코드에 함수형 사고 적용하기

### 함수형 코드라고 하기 어려운 예시 - 액션이 코드 전체로 퍼져나간다

- 다음은 자회사에 수수료를 보내기 위해 만든 코드
- sendPayout() 함수는 실제 은행 계좌로 송금하는 액션

```tsx
function figurePayout(affiliate) {
  var owed = affiliate.sales * affiliate.commission;
  if (owed > 100) {
    sendPayout(affiliate.bank_code, owed); // 액션
  }
}

function affiliatePayout(affiliates) {
  for (var a = 0; a < affiliates.length; a++) {
    figurePayout(affiliates[a]);
  }
}

function main(affiliates) {
  affiliatePayout(affiliates);
}
```

1. sendPayout() 코드는 실제 돈을 송금하는 코드로 호출 시점이나 횟수가 중요하기 때문에 액션임
   - sendPayout 함수는 액션
2. figurePayout() 함수는 액션인 sendPayout() 함수를 호출하기 때문에, 마찬가지로 호출 시점과 횟수에 의존하게 되어 액션임. 즉, 함수 안에서 액션을 호출하면 함수 전체가 액션
   - figurePayout 함수는 액션
3. 같은 논리로 affiliatePayout() 함수는 액션인 figurePayout() 함수를 호출하기 때문에 액션임
   - affiliatePayout 함수는 액션
4. 같은 논리로 main() 함수는 액션인 affiliatePayout() 함수를 호출하기 때문에 액션임
   - main 함수는 액션
5. 결론적으로, 코드 전체가 액션임

## 액션은 코드 전체로 퍼집니다

- 위 코드는 잘못된 코드는 아니지만, 함수형 사고를 적용하지 않은 코드임
- 액션을 부르는 함수가 있다면 그 함수도 액션이 됨
- 이런 식으로 작은 액션 하나가 코드 전체로 퍼져 나감
- 액션을 쓰는 순간 코드 전체로 퍼져나가기 때문에 액션을 가능한 사용하지 않으려 해야 함

## 액션은 다양한 형태로 나타납니다

- 액션을 관리하기 위해 액션이 코드에서 어떤 형태로 나타나는지 알아야 함
- 코드가 호출 시점이나 횟수에 의존하는지 생각해 보면 액션이 무엇인지 파악할 수 있음

### 자바스크립트에서 발생할 수 있는 액션

- 함수 호출
- 메서드 호출
- 생성자
- 표현식 (변수 참조, 속성 참조, 배열 참조)
- 상태 (값 할당, 속성 삭제)

## 액션에 대해 자세히 알아보기

### 액션은 무엇입니까?

- 외부 세계에 영향을 주거나 받는 것
- 실행 시점과 횟수에 의존함
  - 언제 실행되는지 - 순서
  - 얼마나 실행되는지 - 반복

### 액션은 어떻게 구현하나요?

- 함수로 구현
- 계산도 함수로 구현하기 때문에 구분하기 쉽진 않음

### 어떻게 액션에 의미를 담을 수 있나요?

- 액션으로 외부 세상에 영향을 줄 수 있으므로 어떤 일을 하려는지 아는 것이 중요함
- 액션의 예
  - 이메일 보내기, 계좌에서 인출하기, 전역변숫값 바꾸기, ajax 요청 보내기

### 액션은 일반적으로 무엇이라고 하나요?

- 순수하지 않은 함수, 부수 효과 함수, 부수 효과가 있는 함수라 부름

### 액션은 쉽지 않습니다

- 액션은 다루기 힘듦
- 액션은 우리가 소프트웨어를 실행하려는 가장 중요한 이유

### 액션을 잘 사용하기 위한 방법

1. 가능한 액션을 적게 사용한다
   - 액션 대신 계산을 사용할 수 있는지 생각해 봐야 함
2. 액션은 가능한 작게 만든다
   - 액션에서 액션과 관련 없는 코드는 모두 제거해야 함
   - 액션에서 결정이나 계획과 관련된 부분은 계산으로 빼낼 수 있음
3. 액션이 외부 세계와 상호작용하는 것을 제한할 수 있다
   - 내부에 계산과 데이터만 있고 가장 바깥쪽에 액션이 있는 구조가 이상적
   - 어니언 아키텍처와 관련
4. 액션이 호출 시점에 의존하는 것을 제한한다

## 결론

- 액션은 실행 시점이나 횟수에 의존하며 외부 세계에 영향을 주거나 받음
- 계산은 입력값으로 출력값을 만드는 것으로 외부 세계에 영향을 주거나 받지 않고 실행 시점이나 횟수에 의존하지 않음
- 데이터는 이벤트에 대한 사실이며 사실은 변하지 않기 때문에 영구적으로 기록할 수 있음
- 함수형 프로그래머는 액션보다 계산을 좋아하고 계산보다 데이터를 좋아함
- 계산은 같은 입력값을 주면 항상 같은 출력값이 나오기 때문에 액션보다 테스트하기 쉬움
