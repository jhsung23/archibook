# 2. 현실에서의 함수형 사고

## 액션과 계산, 데이터

### 1. 액션

- 호출 횟수와 시점에 의존하는 것
- 오븐이나 배달차 같은 자원과 요리 재료를 사용하는 것
- ex.
  - 반죽 펴기
  - 피자 배달
  - 재료 주문

### 2. 계산

- 어떤 것을 결정하거나 계획하는 것
- 아무 때나 실행해도 다른 곳에 영향을 주지 않음
- ex.
  - 조리법에 나온 것을 두 배로 만들기
  - 쇼핑 목록 결정

### 3. 데이터

- 결제, 재고, 피자 조리법 같은 것
- ex.
  - 고객 주문
  - 영수증
  - 조리법

## 변경 가능성에 따라 코드 나누기

### 계층화 설계

- 코드를 변경할 때 드는 비용을 줄이기 위해 함수형 사고로 코드를 구성하는 것이 좋음
- 변경 가능성에 따라 코드 나누기
  - 비즈니스 규칙 - 변경 가능성 높음 - 의존성이 낮아 쉽게 변경할 수 있음
  - 도메인 규칙 - 변경 가능성 보통
  - 기술 스택 - 변경 가능성 낮음 - 의존성이 많아 바꾸기 어려우나 자주 변경되지 않음
- 각 계층은 그 아래 계층을 기반으로 만들어짐
- 계층형 설계로 만든 코드는 테스트, 재사용, 유지보수가 쉬움

## 일급 추상

### 타임라인 다이어그램

- 시간에 따라 변하는 액션을 시각화하는 방법
- 타임라인에 있는 모든 단계는 액션
- 타임라인 다이어그램을 사용하면 액션이 시간 순서에 따라 어떻게 실행되는지 볼 수 있음
- 액션은 실행 시점에 의존하기 때문에 실행 순서가 중요함

### 분산 시스템을 타임라인으로 시각화하기

- 분산 시스템에서 독립된 액션의 실행 순서는 어떻게 될지 모름
  - 각각의 타임라인에서 처리되는 일은 순서가 섞여 무엇이 먼저 완료될지 알 수 없음

### 각각의 타임라인은 다른 순서로 실행됩니다

- 기본적으로 타임라인은 서로 순서를 맞출 수 있는 기능이 없음
- 서로 다른 타임라인에 있는 액션 간 실행 순서는 보장할 수 없음
- 타임라인을 서로 맞추지 않은 분산 시스템은 예측 불가능한 순서로 실행됨

### 타임라인 커팅

- 여러 타임라인이 동시에 진행될 때 서로 순서를 맞추는 방법
- 고차 동작으로 구현함
- 각 타임라인은 독립적으로 동작하고 작업이 완료되면 다른 타임라인 끝나기를 기다리기 때문에 어떤 타임라인이 먼저 끝나도 괜찮음
